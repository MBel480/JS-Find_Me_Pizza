<!DOCTYPE html>

<html>
	<head>

		<link rel="stylesheet" href="locator.css">

	</head>

	<body>

		<div id="map"></div>

		<div id="latLng">
			<form action="">
				<fieldset>

					<label>Map Latitude:</label>
					<input type="text" id="lat"/>
					<label>Map Longitude:</label>
					<input type="text" id="lng"/>
					<label>Marker Latitude:</label>
					<input type="text" id="marklat">
					<label>Marker Longitude:</label>
					<input type="text" id="marklng">

				</fieldset>
			</form>
		</div>

			<script>

				var mainMap,
					mapMarkers = [];

				function initMap() {

					/*============================
					Map centered on Washington, D.C.
					with main map controls active
					==============================*/

					var sanFrancisco = {lat: 37.773972, lng: -122.431297},
						mapDiv = document.getElementById('map');

					var mapOptions = {

					center: {lat: 38.889931, lng: -77.009003},

					zoom: 8,

					zoomControl: true,

					mapTypeControl: true,

					scaleControl: true,

					streetViewControl: true,

					mapTypeId: google.maps.MapTypeId.HYBRID
		
					};

					mainMap = new google.maps.Map(mapDiv, mapOptions);

					/*============================
					Map right-click event displays
					latitude and longitude to user
					==============================*/

					google.maps.event.addListener(mainMap, "rightclick", function(event) {

						var latitude = event.latLng.lat(),
							longitude = event.latLng.lng(),
							latOutput = document.getElementById("lat"),
							lngOutput = document.getElementById("lng");

						latOutput.value = latitude;
						lngOutput.value = longitude;

					});

					locationMarker = new google.maps.Marker({
							map: mainMap,
							draggable: true,
							position: mainMap.getCenter()
						});
						

					google.maps.event.addListener(locationMarker,"click", function(event) {
						document.getElementById("marklat").value = event.latLng.lat();
						document.getElementById("marklng").value = event.latLng.lng();
						location.position = {lat: event.latLng.lat(), lng: event.latLng.lng()};
						locationMarker.setMap(map);
						mapMarkers.push(locationMarker);
					});

					google.maps.event.addListener(locationMarker, "dragend", function(event) {
						document.getElementById("marklat").value = locationMarker.getPosition().lat();
						document.getElementById("marklng").value = locationMarker.getPosition().lng();
					});

					/*============================
					Center map using geolocation 
					(if supported by browser)
					==============================*/
					getCurrentLocation();
				}

				function getCurrentLocation() {

					if (navigator.geolocation) {

						navigator.geolocation.getCurrentPosition(showPosition);

					}else {

					
						alert("Geolocation not supported by browser; centering map on San Francisco ");

						mainMap.setCenter(sanFrancisco);

					}
				}

				function showPosition(position) {

					var presentLocation = new google.maps.LatLng(position.coords.latitude,
						position.coords.longitude);

					mainMap.setCenter(presentLocation);
				}

				function removeMapMarkers() {
					var i = 0;

					for(i = 0; i < mapMarkers.length; i++) {

						mapMarkers[i].setMap(null);

					}
				}

			</script>

			<script src='locator.js?onload=initialize'></script>

			<script asyn defer
				src="https://maps.googleapis.com/maps/api/js?ey=AIzaSyAmrQjhfl2vtd_xRE8VQdF-C5z-SncAev0&callback=initMap"
			></script>

	</body>

</html>